# Aura AI í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ í†µí•© ìŠ¤í™ì„œ

> **ëŒ€ìƒ**: ë°±ì—”ë“œ ê°œë°œíŒ€, Aura Platform ê°œë°œíŒ€  
> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-16  
> **í”„ë¡ íŠ¸ì—”ë“œ ë²„ì „**: v1.0  
> **ì¶œì²˜**: dwp-frontend/docs/BACKEND_API_SPEC.md

---

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” Aura AI UIê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ ë°±ì—”ë“œì—ì„œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ëª¨ë“  API ë° SSE ì´ë²¤íŠ¸ ìŠ¤í™ì„ ì •ì˜í•©ë‹ˆë‹¤.

í”„ë¡ íŠ¸ì—”ë“œëŠ” ë‹¤ìŒ 4ê°œì˜ íƒ­ìœ¼ë¡œ AIì˜ ì‘ì—… ê³¼ì •ì„ ì‹œê°í™”í•©ë‹ˆë‹¤:
1. **ì‚¬ê³  ê³¼ì •** (Thought Process): AIì˜ ë‚´ë¶€ ì‚¬ê³  ì²´ì¸
2. **ì‘ì—… ê³„íš** (Work Plan): ë‹¨ê³„ë³„ ì‹¤í–‰ ê³„íš
3. **ì‹¤í–‰ ë¡œê·¸** (Execution Log): ë„êµ¬ ì‹¤í–‰ ê¸°ë¡
4. **ê²°ê³¼** (Results): ìµœì¢… ê²°ê³¼ë¬¼

---

## ğŸ”„ SSE ìŠ¤íŠ¸ë¦¬ë° ì—”ë“œí¬ì¸íŠ¸

### ì—”ë“œí¬ì¸íŠ¸

**í”„ë¡ íŠ¸ì—”ë“œ ìš”êµ¬ì‚¬í•­**: `POST /api/aura/test/stream`

**ìš”ì²­ í˜•ì‹**:
```http
POST /api/aura/test/stream
Content-Type: application/json
Authorization: Bearer {JWT_TOKEN}
X-Tenant-ID: {TENANT_ID}

{
  "prompt": "ì‚¬ìš©ì ì§ˆë¬¸",
  "context": {
    "url": "http://localhost:4200/mail",
    "path": "/mail",
    "title": "ë©”ì¼ ì¸ë°•ìŠ¤",
    "activeApp": "mail",
    "itemId": "msg-123",
    "metadata": {
      "headings": ["ë°›ì€ ë©”ì¼í•¨", "ì¤‘ìš” ë©”ì¼"],
      "hasTables": true,
      "tableCount": 1
    }
  }
}
```

**ì‘ë‹µ í˜•ì‹**: `text/event-stream`

ê° ì´ë²¤íŠ¸ëŠ” ë‹¤ìŒ í˜•ì‹ ì¤‘ í•˜ë‚˜ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

```
event: {type}
data: {JSON_OBJECT}\n\n
```

ë˜ëŠ” ê°„ë‹¨í•œ í˜•ì‹:

```
data: {JSON_OBJECT}\n\n
```

ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ:

```
data: [DONE]\n\n
```

---

## ğŸ“¡ í•„ìˆ˜ SSE ì´ë²¤íŠ¸ íƒ€ì…

### 1. `thought` / `thinking` (ì‚¬ê³  ê³¼ì •)

**ìš©ë„**: AIì˜ ë‚´ë¶€ ì‚¬ê³  ê³¼ì •ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ "ì‚¬ê³  ê³¼ì •" íƒ­ì— í‘œì‹œ

**ì´ë²¤íŠ¸ í˜•ì‹**:
```json
{
  "type": "thought" | "thinking",
  "thoughtType": "analysis" | "planning" | "execution" | "verification",
  "content": "ì‚¬ìš©ì ìš”ì²­ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...",
  "sources": [
    {
      "type": "code" | "conversation" | "metadata",
      "name": "mail/inbox.tsx",
      "path": "apps/mail/src/pages/inbox.tsx"
    }
  ]
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- `ThoughtChainUI` ì»´í¬ë„ŒíŠ¸ì— íƒ€ì„ë¼ì¸ìœ¼ë¡œ í‘œì‹œ
- `type`ì— ë”°ë¼ ì•„ì´ì½˜ ë° ìƒ‰ìƒ ë³€ê²½
- `sources` ë°°ì—´ì„ ì¹© í˜•íƒœë¡œ í‘œì‹œ

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "thought" ë˜ëŠ” "thinking"
- âœ… `content`: ì‚¬ê³  ë‚´ìš© (ë¬¸ìì—´)
- âš ï¸ `thoughtType`: "analysis", "planning", "execution", "verification" ì¤‘ í•˜ë‚˜ (ì—†ìœ¼ë©´ "analysis"ë¡œ ê¸°ë³¸ê°’)
- âš ï¸ `sources`: ì°¸ê³  ìë£Œ ë°°ì—´ (ì„ íƒ, ì—†ìœ¼ë©´ í‘œì‹œ ì•ˆ í•¨)

---

### 2. `plan_step` (ì‘ì—… ê³„íš)

**ìš©ë„**: AIê°€ ìˆ˜ë¦½í•œ ì‘ì—… ê³„íšì˜ ê° ë‹¨ê³„ë¥¼ "ì‘ì—… ê³„íš" íƒ­ì— í‘œì‹œ

**ì´ë²¤íŠ¸ í˜•ì‹**:
```json
{
  "type": "plan_step",
  "title": "1. í˜ì´ì§€ êµ¬ì¡° ë¶„ì„",
  "description": "í˜„ì¬ ë©”ì¼ ì¸ë°•ìŠ¤ì˜ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.",
  "order": 0,
  "canSkip": false,
  "confidence": 0.9
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- `DynamicPlanBoard` ì»´í¬ë„ŒíŠ¸ì— ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œ
- `order` í•„ë“œë¡œ ì •ë ¬
- ì‚¬ìš©ìê°€ ìˆœì„œ ë³€ê²½, ìŠ¹ì¸, ê±´ë„ˆë›°ê¸° ê°€ëŠ¥
- `confidence`ê°€ ë‚®ìœ¼ë©´ ê²½ê³  ìƒ‰ìƒ í‘œì‹œ

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "plan_step"
- âœ… `title`: ë‹¨ê³„ ì œëª©
- âœ… `description`: ë‹¨ê³„ ì„¤ëª…
- âœ… `order`: ìˆœì„œ (0ë¶€í„° ì‹œì‘, ì •ìˆ˜)
- âš ï¸ `canSkip`: ê±´ë„ˆë›°ê¸° ê°€ëŠ¥ ì—¬ë¶€ (ê¸°ë³¸ê°’: false)
- âš ï¸ `confidence`: ì‹ ë¢°ë„ (0.0 ~ 1.0, ê¸°ë³¸ê°’: ì—†ìŒ)

**ìƒíƒœ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸** (ì„ íƒ):
```json
{
  "type": "plan_step_update",
  "id": "plan-step-123",
  "status": "pending" | "approved" | "skipped" | "executing" | "completed" | "failed",
  "description": "ì—…ë°ì´íŠ¸ëœ ì„¤ëª…",
  "confidence": 0.85
}
```

---

### 3. `tool_execution` / `action` (ë„êµ¬ ì‹¤í–‰)

**ìš©ë„**: AIê°€ ì‹¤í–‰í•˜ëŠ” ë„êµ¬(Git, Jira, Code Analyzer ë“±)ì˜ ì‹¤í–‰ ìƒíƒœë¥¼ "ì‹¤í–‰ ë¡œê·¸" íƒ­ì— í‘œì‹œ

**ì´ë²¤íŠ¸ í˜•ì‹** (ì‹¤í–‰ ì‹œì‘):
```json
{
  "type": "tool_execution" | "action",
  "tool": "code_analyzer" | "git_diff" | "jira_create" | "mail_send" | ...,
  "params": {
    "file": "apps/mail/src/pages/inbox.tsx",
    "operation": "analyze"
  },
  "status": "executing"
}
```

**ì´ë²¤íŠ¸ í˜•ì‹** (ì‹¤í–‰ ì™„ë£Œ):
```json
{
  "type": "tool_execution" | "action",
  "tool": "code_analyzer",
  "params": {
    "file": "apps/mail/src/pages/inbox.tsx"
  },
  "status": "completed",
  "result": "Found 3 main components: MailList, FilterBar, SearchBox"
}
```

**ì´ë²¤íŠ¸ í˜•ì‹** (ì‹¤í–‰ ì‹¤íŒ¨):
```json
{
  "type": "tool_execution" | "action",
  "tool": "code_analyzer",
  "params": {
    "file": "apps/mail/src/pages/inbox.tsx"
  },
  "status": "failed",
  "error": "File not found"
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- `ActionExecutionView` ì»´í¬ë„ŒíŠ¸ì— ë¡œê·¸ í˜•íƒœë¡œ í‘œì‹œ
- `LiveExecutionLog` ì»´í¬ë„ŒíŠ¸ì— í„°ë¯¸ë„ ìŠ¤íƒ€ì¼ë¡œ í‘œì‹œ
- `status`ì— ë”°ë¼ ìƒ‰ìƒ ë³€ê²½ (executing: ë…¸ë‘, completed: ì´ˆë¡, failed: ë¹¨ê°•)

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "tool_execution" ë˜ëŠ” "action"
- âœ… `tool`: ë„êµ¬ ì´ë¦„ (ë¬¸ìì—´)
- âœ… `params`: ë„êµ¬ íŒŒë¼ë¯¸í„° (ê°ì²´)
- âœ… `status`: "executing" | "completed" | "failed"
- âš ï¸ `result`: ì‹¤í–‰ ê²°ê³¼ (completedì¼ ë•Œ)
- âš ï¸ `error`: ì—ëŸ¬ ë©”ì‹œì§€ (failedì¼ ë•Œ)

**ì£¼ì˜ì‚¬í•­**:
- ê°™ì€ `tool`ê³¼ `params` ì¡°í•©ì— ëŒ€í•´ ì‹¤í–‰ ì‹œì‘ â†’ ì™„ë£Œ/ì‹¤íŒ¨ ìˆœì„œë¡œ ì „ì†¡í•´ì•¼ í•¨
- í”„ë¡ íŠ¸ì—”ë“œëŠ” ì‹¤í–‰ ì‹œì‘ ì‹œ `status: "executing"`ìœ¼ë¡œ ì¶”ê°€í•˜ê³ , ì™„ë£Œ/ì‹¤íŒ¨ ì‹œ ì—…ë°ì´íŠ¸í•¨

---

### 4. `hitl` / `approval_required` (ìŠ¹ì¸ ìš”ì²­)

**ìš©ë„**: ì¤‘ìš”í•œ ì‘ì—… ì „ ì‚¬ìš©ì ìŠ¹ì¸ì„ ìš”ì²­í•˜ì—¬ "CheckpointApproval" ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ

**ì´ë²¤íŠ¸ í˜•ì‹**:
```json
{
  "type": "hitl" | "approval_required",
  "data": {
    "requestId": "hitl-1234567890",
    "message": "ë©”ì¼ 3ê°œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
    "actionType": "delete_emails",
    "params": {
      "ids": ["msg-123", "msg-456", "msg-789"]
    },
    "confidence": 0.7,
    "editableContent": "ë©”ì¼ 3ê°œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
  }
}
```

ë˜ëŠ” ê°„ë‹¨í•œ í˜•ì‹:
```json
{
  "type": "hitl",
  "requestId": "hitl-1234567890",
  "message": "ë©”ì¼ 3ê°œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
  "action": "delete_emails",
  "params": {
    "ids": ["msg-123", "msg-456", "msg-789"]
  },
  "confidence": 0.7,
  "editableContent": "ë©”ì¼ 3ê°œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- `CheckpointApproval` ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
- ìŠ¤íŠ¸ë¦¬ë° ì¼ì‹œ ì¤‘ì§€ (ì‚¬ìš©ì ìŠ¹ì¸ ëŒ€ê¸°)
- ì‚¬ìš©ìê°€ ìŠ¹ì¸/ê±°ì ˆ ì‹œ `/api/aura/hitl/approve/{requestId}` ë˜ëŠ” `/api/aura/hitl/reject/{requestId}` í˜¸ì¶œ

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "hitl" ë˜ëŠ” "approval_required"
- âœ… `requestId`: ê³ ìœ í•œ ìš”ì²­ ID (ë¬¸ìì—´)
- âœ… `message`: ì‚¬ìš©ìì—ê²Œ í‘œì‹œí•  ë©”ì‹œì§€
- âœ… `action` ë˜ëŠ” `actionType`: ì‹¤í–‰í•  ì•¡ì…˜ ì´ë¦„
- âœ… `params`: ì•¡ì…˜ íŒŒë¼ë¯¸í„° (ê°ì²´)
- âš ï¸ `confidence`: ì‹ ë¢°ë„ (0.0 ~ 1.0, ì—†ìœ¼ë©´ í‘œì‹œ ì•ˆ í•¨)
- âš ï¸ `editableContent`: ì‚¬ìš©ìê°€ ìˆ˜ì • ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸ (ì—†ìœ¼ë©´ `message` ì‚¬ìš©)

**ì¤‘ìš”**:
- `hitl` ì´ë²¤íŠ¸ê°€ ì „ì†¡ë˜ë©´ í”„ë¡ íŠ¸ì—”ë“œëŠ” ìŠ¤íŠ¸ë¦¬ë°ì„ ì¼ì‹œ ì¤‘ì§€í•©ë‹ˆë‹¤.
- ì‚¬ìš©ìê°€ ìŠ¹ì¸/ê±°ì ˆí•  ë•Œê¹Œì§€ ìŠ¤íŠ¸ë¦¬ë°ì´ ì¬ê°œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ìŠ¹ì¸ í›„ ë°±ì—”ë“œëŠ” ìŠ¤íŠ¸ë¦¬ë°ì„ ê³„ì† ì§„í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

---

### 5. `content` / `message` (ìµœì¢… ì‘ë‹µ)

**ìš©ë„**: AIì˜ ìµœì¢… ì‘ë‹µ í…ìŠ¤íŠ¸ë¥¼ ì±„íŒ…ì°½ì— í‘œì‹œ

**ì´ë²¤íŠ¸ í˜•ì‹**:
```json
{
  "type": "content",
  "content": "í˜„ì¬ í˜ì´ì§€ëŠ” ë©”ì¼ ì¸ë°•ìŠ¤ í™”ë©´ì…ë‹ˆë‹¤.\n\n**ì£¼ìš” ê¸°ëŠ¥:**\n- ì½ì§€ ì•Šì€ ë©”ì¼ í•„í„°ë§\n- ë©”ì¼ ëª©ë¡ í‘œì‹œ\n- ê²€ìƒ‰ ê¸°ëŠ¥"
}
```

ë˜ëŠ” ê°„ë‹¨í•œ í˜•ì‹:
```json
{
  "type": "message",
  "message": "ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

**ê²°ê³¼ë¬¼ í¬í•¨ í˜•ì‹** (ê²°ê³¼ íƒ­ì— í‘œì‹œ):
```json
{
  "type": "content",
  "content": "ì½”ë“œ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "metadata": {
    "result": {
      "type": "diff" | "preview" | "checklist" | "text",
      "content": "...",
      "title": "ì½”ë“œ ë³€ê²½ì‚¬í•­"
    }
  }
}
```

**ì¤‘ìš”**: `metadata.result`ê°€ í¬í•¨ëœ `content` ì´ë²¤íŠ¸ëŠ” ë§ˆì§€ë§‰ `content` ì´ë²¤íŠ¸ì—¬ì•¼ í•©ë‹ˆë‹¤.
í”„ë¡ íŠ¸ì—”ë“œëŠ” ìŠ¤íŠ¸ë¦¬ë° ì¢…ë£Œ ì‹œ ë§ˆì§€ë§‰ `content` ì´ë²¤íŠ¸ì˜ `metadata.result`ë¥¼ ë©”ì‹œì§€ì— ì €ì¥í•©ë‹ˆë‹¤.

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- ì±„íŒ…ì°½ì— ìŠ¤íŠ¸ë¦¬ë° í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ
- `metadata.result`ê°€ ìˆìœ¼ë©´ "ê²°ê³¼" íƒ­ì— `ResultViewer`ë¡œ í‘œì‹œ

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "content" ë˜ëŠ” "message"
- âœ… `content` ë˜ëŠ” `message`: ì‘ë‹µ í…ìŠ¤íŠ¸
- âš ï¸ `metadata.result`: ê²°ê³¼ ê°ì²´ (ì„ íƒ)

**ê²°ê³¼ íƒ€ì…ë³„ í˜•ì‹**:

1. **diff** (ì½”ë“œ ë³€ê²½ì‚¬í•­):
```json
{
  "type": "diff",
  "content": "--- a/file.ts\n+++ b/file.ts\n@@ -1,3 +1,4 @@\n...",
  "title": "ì½”ë“œ ë³€ê²½ì‚¬í•­"
}
```

2. **preview** (ë¬¸ì„œ í”„ë¦¬ë·°):
```json
{
  "type": "preview",
  "content": "ë¬¸ì„œ ë‚´ìš© ë˜ëŠ” HTML",
  "title": "ë¬¸ì„œ í”„ë¦¬ë·°"
}
```

3. **checklist** (ì²´í¬ë¦¬ìŠ¤íŠ¸):
```json
{
  "type": "checklist",
  "content": [
    { "label": "ì‘ì—… 1", "checked": true },
    { "label": "ì‘ì—… 2", "checked": false }
  ],
  "title": "ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸"
}
```

4. **text** (ì¼ë°˜ í…ìŠ¤íŠ¸, ê¸°ë³¸ê°’):
```json
{
  "type": "text",
  "content": "ì¼ë°˜ í…ìŠ¤íŠ¸ ê²°ê³¼",
  "title": "ê²°ê³¼"
}
```

---

### 6. `timeline_step_update` (íƒ€ì„ë¼ì¸ ë‹¨ê³„ ì—…ë°ì´íŠ¸)

**ìš©ë„**: "ì‚¬ê³  ê³¼ì •" íƒ­ì˜ ì‹¤í–‰ íƒ€ì„ë¼ì¸ ë‹¨ê³„ ìƒíƒœ ì—…ë°ì´íŠ¸

**ì´ë²¤íŠ¸ í˜•ì‹**:
```json
{
  "type": "timeline_step_update",
  "id": "timeline-step-123",
  "status": "pending" | "processing" | "completed" | "failed",
  "title": "ì—…ë°ì´íŠ¸ëœ ì œëª©",
  "description": "ì—…ë°ì´íŠ¸ëœ ì„¤ëª…"
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**:
- `ReasoningTimeline` ì»´í¬ë„ŒíŠ¸ì˜ í•´ë‹¹ ë‹¨ê³„ ìƒíƒœ ì—…ë°ì´íŠ¸
- `status`ì— ë”°ë¼ ì•„ì´ì½˜ ë° ìƒ‰ìƒ ë³€ê²½

**í•„ìˆ˜ í•„ë“œ**:
- âœ… `type`: "timeline_step_update"
- âœ… `id`: íƒ€ì„ë¼ì¸ ë‹¨ê³„ ID (ë¬¸ìì—´)
- âœ… `status`: "pending" | "processing" | "completed" | "failed"
- âš ï¸ `title`: ì—…ë°ì´íŠ¸ëœ ì œëª© (ì„ íƒ)
- âš ï¸ `description`: ì—…ë°ì´íŠ¸ëœ ì„¤ëª… (ì„ íƒ)

**ì°¸ê³ **:
- í”„ë¡ íŠ¸ì—”ë“œëŠ” ì´ˆê¸°ì— íƒ€ì„ë¼ì¸ ë‹¨ê³„ë¥¼ ìƒì„±í•˜ì§€ë§Œ, ë°±ì—”ë“œê°€ `timeline_step_update`ë¥¼ ë³´ë‚´ë©´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
- `id`ëŠ” í”„ë¡ íŠ¸ì—”ë“œê°€ ìƒì„±í•œ IDì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

---

## ğŸ” HITL ìŠ¹ì¸/ê±°ì ˆ API

### ìŠ¹ì¸ ìš”ì²­

```http
POST /api/aura/hitl/approve/{requestId}
Content-Type: application/json
Authorization: Bearer {JWT_TOKEN}
X-Tenant-ID: {TENANT_ID}
X-User-ID: {USER_ID}

{
  "userId": "{USER_ID}"
}
```

**ì‘ë‹µ í˜•ì‹**:
```json
{
  "status": "SUCCESS",
  "message": "Request approved successfully",
  "data": {
    "requestId": "hitl-1234567890",
    "sessionId": "session-abc",
    "status": "approved"
  },
  "success": true,
  "timestamp": "2026-01-16T12:00:00"
}
```

**ì¤‘ìš”**:
- ìŠ¹ì¸ í›„ ë°±ì—”ë“œëŠ” SSE ìŠ¤íŠ¸ë¦¬ë°ì„ ì¬ê°œí•´ì•¼ í•©ë‹ˆë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œëŠ” ìŠ¹ì¸ í›„ ìŠ¤íŠ¸ë¦¬ë° ìƒíƒœë¥¼ `true`ë¡œ ì„¤ì •í•˜ê³  ëŒ€ê¸°í•©ë‹ˆë‹¤.

---

### ê±°ì ˆ ìš”ì²­

```http
POST /api/aura/hitl/reject/{requestId}
Content-Type: application/json
Authorization: Bearer {JWT_TOKEN}
X-Tenant-ID: {TENANT_ID}
X-User-ID: {USER_ID}

{
  "userId": "{USER_ID}",
  "reason": "ì‚¬ìš©ìê°€ ì‘ì—…ì„ ê±°ë¶€í–ˆìŠµë‹ˆë‹¤."
}
```

**ì‘ë‹µ í˜•ì‹**:
```json
{
  "status": "SUCCESS",
  "message": "Request rejected",
  "data": {
    "requestId": "hitl-1234567890",
    "sessionId": "session-abc",
    "status": "rejected",
    "reason": "ì‚¬ìš©ìê°€ ì‘ì—…ì„ ê±°ë¶€í–ˆìŠµë‹ˆë‹¤."
  },
  "success": true,
  "timestamp": "2026-01-16T12:00:00"
}
```

**ì¤‘ìš”**:
- ê±°ì ˆ í›„ ë°±ì—”ë“œëŠ” ìŠ¤íŠ¸ë¦¬ë°ì„ ì¢…ë£Œí•˜ê±°ë‚˜ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œëŠ” ê±°ì ˆ í›„ ìŠ¤íŠ¸ë¦¬ë° ìƒíƒœë¥¼ `false`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

---

## ğŸ”„ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ í”Œë¡œìš°

### ì •ìƒ í”Œë¡œìš°

```
1. ì‚¬ìš©ì ì§ˆë¬¸ ì „ì†¡
   â†“
2. ë°±ì—”ë“œ: thought ì´ë²¤íŠ¸ ì „ì†¡ (ì‚¬ê³  ê³¼ì • íƒ­ ì—…ë°ì´íŠ¸)
   â†“
3. ë°±ì—”ë“œ: plan_step ì´ë²¤íŠ¸ë“¤ ì „ì†¡ (ì‘ì—… ê³„íš íƒ­ ì—…ë°ì´íŠ¸)
   â†“
4. ë°±ì—”ë“œ: tool_execution ì´ë²¤íŠ¸ ì „ì†¡ (status: "executing")
   â†“
5. ë°±ì—”ë“œ: tool_execution ì´ë²¤íŠ¸ ì „ì†¡ (status: "completed" ë˜ëŠ” "failed")
   â†“
6. ë°±ì—”ë“œ: content ì´ë²¤íŠ¸ ì „ì†¡ (ì±„íŒ…ì°½ ë° ê²°ê³¼ íƒ­ ì—…ë°ì´íŠ¸)
   â†“
7. ë°±ì—”ë“œ: data: [DONE] ì „ì†¡ (ìŠ¤íŠ¸ë¦¬ë° ì¢…ë£Œ)
```

### HITL í”Œë¡œìš°

```
1. ì‚¬ìš©ì ì§ˆë¬¸ ì „ì†¡
   â†“
2. ë°±ì—”ë“œ: thought, plan_step ì´ë²¤íŠ¸ë“¤ ì „ì†¡
   â†“
3. ë°±ì—”ë“œ: hitl ì´ë²¤íŠ¸ ì „ì†¡
   â†“
4. í”„ë¡ íŠ¸ì—”ë“œ: ìŠ¤íŠ¸ë¦¬ë° ì¼ì‹œ ì¤‘ì§€, ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
   â†“
5. ì‚¬ìš©ì ìŠ¹ì¸/ê±°ì ˆ
   â†“
6-1. ìŠ¹ì¸: POST /api/aura/hitl/approve/{requestId}
      â†’ ë°±ì—”ë“œ: ìŠ¤íŠ¸ë¦¬ë° ì¬ê°œ, tool_execution ì´ë²¤íŠ¸ë“¤ ì „ì†¡
   â†“
6-2. ê±°ì ˆ: POST /api/aura/hitl/reject/{requestId}
      â†’ ë°±ì—”ë“œ: ìŠ¤íŠ¸ë¦¬ë° ì¢…ë£Œ ë˜ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ ì „ì†¡
```

---

## âš ï¸ ì¤‘ìš” ì£¼ì˜ì‚¬í•­

### 1. ì´ë²¤íŠ¸ ìˆœì„œ

- ì´ë²¤íŠ¸ëŠ” ìˆœì°¨ì ìœ¼ë¡œ ì „ì†¡ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
- `tool_execution`ì˜ ê²½ìš° `status: "executing"` â†’ `status: "completed"` ìˆœì„œë¡œ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤.

### 2. ì´ë²¤íŠ¸ ID ê´€ë¦¬

- `plan_step_update`ì˜ `id`ëŠ” í”„ë¡ íŠ¸ì—”ë“œê°€ ìƒì„±í•œ `plan_step`ì˜ `id`ì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
- `timeline_step_update`ì˜ `id`ëŠ” í”„ë¡ íŠ¸ì—”ë“œê°€ ìƒì„±í•œ `TimelineStep`ì˜ `id`ì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
- **ê¶Œì¥**: ë°±ì—”ë“œê°€ `plan_step` ì´ë²¤íŠ¸ì— `id` í•„ë“œë¥¼ í¬í•¨í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œê°€ ì‚¬ìš©í•˜ë„ë¡ í•¨

### 3. HITL ìŠ¹ì¸ í›„ ìŠ¤íŠ¸ë¦¬ë° ì¬ê°œ

- ìŠ¹ì¸ API í˜¸ì¶œ í›„ ë°±ì—”ë“œëŠ” **ê°™ì€ SSE ì—°ê²°**ì—ì„œ ìŠ¤íŠ¸ë¦¬ë°ì„ ì¬ê°œí•´ì•¼ í•©ë‹ˆë‹¤.
- ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ì„ ì‹œì‘í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.

### 4. ì—ëŸ¬ ì²˜ë¦¬

- ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì—ëŸ¬ ë°œìƒ ì‹œ `tool_execution` ì´ë²¤íŠ¸ë¡œ `status: "failed"`ì™€ `error` í•„ë“œë¥¼ ì „ì†¡í•˜ê±°ë‚˜,
- `content` ì´ë²¤íŠ¸ë¡œ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤.

### 5. ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ

- ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ë°˜ë“œì‹œ `data: [DONE]`ì„ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œëŠ” ì´ë¥¼ ë°›ìœ¼ë©´ ìŠ¤íŠ¸ë¦¬ë° ìƒíƒœë¥¼ `false`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ë³¸ ì§ˆë¬¸-ì‘ë‹µ

1. ì‚¬ìš©ì: "í˜„ì¬ í™”ë©´ì„ ë¶„ì„í•´ì£¼ì„¸ìš”"
2. ë°±ì—”ë“œ ì „ì†¡:
   - `thought` ì´ë²¤íŠ¸ (ì‚¬ê³  ê³¼ì •)
   - `plan_step` ì´ë²¤íŠ¸ë“¤ (ì‘ì—… ê³„íš)
   - `tool_execution` ì´ë²¤íŠ¸ë“¤ (ë„êµ¬ ì‹¤í–‰)
   - `content` ì´ë²¤íŠ¸ (ìµœì¢… ì‘ë‹µ)
   - `data: [DONE]`

**ì˜ˆìƒ ê²°ê³¼**:
- ì‚¬ê³  ê³¼ì • íƒ­: íƒ€ì„ë¼ì¸ í‘œì‹œ
- ì‘ì—… ê³„íš íƒ­: ê³„íš ì¹´ë“œë“¤ í‘œì‹œ
- ì‹¤í–‰ ë¡œê·¸ íƒ­: ì‹¤í–‰ ê¸°ë¡ í‘œì‹œ
- ê²°ê³¼ íƒ­: ìµœì¢… ì‘ë‹µ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 2: HITL ìŠ¹ì¸ í•„ìš”

1. ì‚¬ìš©ì: "ë©”ì¼ 3ê°œë¥¼ ì‚­ì œí•´ì£¼ì„¸ìš”"
2. ë°±ì—”ë“œ ì „ì†¡:
   - `thought` ì´ë²¤íŠ¸
   - `plan_step` ì´ë²¤íŠ¸ë“¤
   - `hitl` ì´ë²¤íŠ¸ (ìŠ¹ì¸ ìš”ì²­)
3. í”„ë¡ íŠ¸ì—”ë“œ: ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ, ìŠ¤íŠ¸ë¦¬ë° ì¼ì‹œ ì¤‘ì§€
4. ì‚¬ìš©ì ìŠ¹ì¸
5. ë°±ì—”ë“œ: `/api/aura/hitl/approve/{requestId}` í˜¸ì¶œ
6. ë°±ì—”ë“œ: ìŠ¤íŠ¸ë¦¬ë° ì¬ê°œ
   - `tool_execution` ì´ë²¤íŠ¸ë“¤
   - `content` ì´ë²¤íŠ¸
   - `data: [DONE]`

**ì˜ˆìƒ ê²°ê³¼**:
- ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ê°€ í‘œì‹œë˜ê³  ì‚¬ìš©ì ìŠ¹ì¸ í›„ ì‘ì—…ì´ ê³„ì† ì§„í–‰ë¨

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°±ì—”ë“œ ê°œë°œ ì™„ë£Œ ì—¬ë¶€ í™•ì¸:

### SSE ìŠ¤íŠ¸ë¦¬ë°
- [ ] `POST /api/aura/test/stream` ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
- [ ] `thought` / `thinking` ì´ë²¤íŠ¸ ì „ì†¡
- [ ] `plan_step` ì´ë²¤íŠ¸ ì „ì†¡
- [ ] `tool_execution` / `action` ì´ë²¤íŠ¸ ì „ì†¡
- [ ] `hitl` / `approval_required` ì´ë²¤íŠ¸ ì „ì†¡
- [ ] `content` / `message` ì´ë²¤íŠ¸ ì „ì†¡
- [ ] `timeline_step_update` ì´ë²¤íŠ¸ ì „ì†¡ (ì„ íƒ)
- [ ] `plan_step_update` ì´ë²¤íŠ¸ ì „ì†¡ (ì„ íƒ)
- [ ] `data: [DONE]` ì „ì†¡

### HITL API
- [ ] `POST /api/aura/hitl/approve/{requestId}` êµ¬í˜„
- [ ] `POST /api/aura/hitl/reject/{requestId}` êµ¬í˜„
- [ ] ìŠ¹ì¸ í›„ ìŠ¤íŠ¸ë¦¬ë° ì¬ê°œ ë¡œì§ êµ¬í˜„
- [ ] ê±°ì ˆ í›„ ìŠ¤íŠ¸ë¦¬ë° ì¢…ë£Œ ë¡œì§ êµ¬í˜„

### ë°ì´í„° í˜•ì‹
- [ ] ëª¨ë“  ì´ë²¤íŠ¸ê°€ ì˜¬ë°”ë¥¸ JSON í˜•ì‹ìœ¼ë¡œ ì „ì†¡ë˜ëŠ”ê°€?
- [ ] í•„ìˆ˜ í•„ë“œê°€ ëª¨ë‘ í¬í•¨ë˜ëŠ”ê°€?
- [ ] ì„ íƒ í•„ë“œê°€ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ë˜ëŠ”ê°€?

---

## ğŸ“ ë¬¸ì˜

í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê´€ë ¨ ë¬¸ì˜:
- Repository: `dwp-frontend`
- ì£¼ìš” íŒŒì¼: 
  - `apps/dwp/src/components/aura/`
  - `apps/dwp/src/pages/ai-workspace.tsx`
  - `apps/dwp/src/store/use-aura-store.ts`

ë°±ì—”ë“œ êµ¬í˜„ ê´€ë ¨ ë¬¸ì˜:
- Repository: `dwp-backend`
- ë¬¸ì„œ: `dwp-backend/docs/FRONTEND_INTEGRATION_GUIDE.md`

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-16  
**ì‘ì„±ì**: DWP Frontend Team
